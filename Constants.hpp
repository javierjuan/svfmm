/***************************************************************************
/* Javier Juan Albarracin - jajuaal1@ibime.upv.es                         */
/* Universidad Politecnica de Valencia, Spain                             */
/*                                                                        */
/* Copyright (C) 2020 Javier Juan Albarracin                              */
/*                                                                        */
/***************************************************************************
* Constants                                                                *
***************************************************************************/

#ifndef CONSTANTS_HPP
#define CONSTANTS_HPP

#include <Eigen/Dense>

using namespace Eigen;

#define SVFMM_INF 1e300
#define SVFMM_ZERO 1e-150
#define SVFMM_EPS 2.220446049250313e-16
#define SVFMM_PI 3.141592653589793
#define SVFMM_2PI 6.283185307179586
#define SVFMM_LOG2PI 1.837877066409345
#define SVFMM_SQRT3 1.732050807568877
#define SVFMM_STUDENT_DEFAULT_NU 1
#define SVFMM_CHI2_DEFAULT_NU 1
#define SVFMM_CHI2_DEFAULT_MIN_Z 1e-5
#define SVFMM_CHI2_DEFAULT_MAX_Z 15
#define SVFMM_TIKHONOV_REGULARIZATION 1e-10
                                                                        //    0.005        0.010        0.025        0.050        0.100        0.900        0.950        0.975        0.990        0.995
static Matrix<double, 101, 10> CHI2TABLE = (Matrix<double, 101, 10>() <<          0,           0,           0,           0,           0,           0,           0,           0,           0,           0,
                                                                        3.92704e-05, 1.57088e-04, 9.82069e-04, 3.93214e-03, 1.57908e-02, 2.70554e+00, 3.84146e+00, 5.02389e+00, 6.63490e+00, 7.87944e+00,
                                                                        1.00251e-02, 2.01007e-02, 5.06356e-02, 1.02587e-01, 2.10721e-01, 4.60517e+00, 5.99146e+00, 7.37776e+00, 9.21034e+00, 1.05966e+01,
                                                                        7.17218e-02, 1.14832e-01, 2.15795e-01, 3.51846e-01, 5.84374e-01, 6.25139e+00, 7.81473e+00, 9.34840e+00, 1.13449e+01, 1.28382e+01,
                                                                        2.06989e-01, 2.97109e-01, 4.84419e-01, 7.10723e-01, 1.06362e+00, 7.77944e+00, 9.48773e+00, 1.11433e+01, 1.32767e+01, 1.48603e+01,
                                                                        4.11742e-01, 5.54298e-01, 8.31212e-01, 1.14548e+00, 1.61031e+00, 9.23636e+00, 1.10705e+01, 1.28325e+01, 1.50863e+01, 1.67496e+01,
                                                                        6.75727e-01, 8.72090e-01, 1.23734e+00, 1.63538e+00, 2.20413e+00, 1.06446e+01, 1.25916e+01, 1.44494e+01, 1.68119e+01, 1.85476e+01,
                                                                        9.89256e-01, 1.23904e+00, 1.68987e+00, 2.16735e+00, 2.83311e+00, 1.20170e+01, 1.40671e+01, 1.60128e+01, 1.84753e+01, 2.02777e+01,
                                                                        1.34441e+00, 1.64650e+00, 2.17973e+00, 2.73264e+00, 3.48954e+00, 1.33616e+01, 1.55073e+01, 1.75345e+01, 2.00902e+01, 2.19550e+01,
                                                                        1.73493e+00, 2.08790e+00, 2.70039e+00, 3.32511e+00, 4.16816e+00, 1.46837e+01, 1.69190e+01, 1.90228e+01, 2.16660e+01, 2.35894e+01,
                                                                        2.15586e+00, 2.55821e+00, 3.24697e+00, 3.94030e+00, 4.86518e+00, 1.59872e+01, 1.83070e+01, 2.04832e+01, 2.32093e+01, 2.51882e+01,
                                                                        2.60322e+00, 3.05348e+00, 3.81575e+00, 4.57481e+00, 5.57778e+00, 1.72750e+01, 1.96751e+01, 2.19200e+01, 2.47250e+01, 2.67568e+01,
                                                                        3.07382e+00, 3.57057e+00, 4.40379e+00, 5.22603e+00, 6.30380e+00, 1.85493e+01, 2.10261e+01, 2.33367e+01, 2.62170e+01, 2.82995e+01,
                                                                        3.56503e+00, 4.10692e+00, 5.00875e+00, 5.89186e+00, 7.04150e+00, 1.98119e+01, 2.23620e+01, 2.47356e+01, 2.76882e+01, 2.98195e+01,
                                                                        4.07467e+00, 4.66043e+00, 5.62873e+00, 6.57063e+00, 7.78953e+00, 2.10641e+01, 2.36848e+01, 2.61189e+01, 2.91412e+01, 3.13193e+01,
                                                                        4.60092e+00, 5.22935e+00, 6.26214e+00, 7.26094e+00, 8.54676e+00, 2.23071e+01, 2.49958e+01, 2.74884e+01, 3.05779e+01, 3.28013e+01,
                                                                        5.14221e+00, 5.81221e+00, 6.90766e+00, 7.96165e+00, 9.31224e+00, 2.35418e+01, 2.62962e+01, 2.88454e+01, 3.19999e+01, 3.42672e+01,
                                                                        5.69722e+00, 6.40776e+00, 7.56419e+00, 8.67176e+00, 1.00852e+01, 2.47690e+01, 2.75871e+01, 3.01910e+01, 3.34087e+01, 3.57185e+01,
                                                                        6.26480e+00, 7.01491e+00, 8.23075e+00, 9.39046e+00, 1.08649e+01, 2.59894e+01, 2.88693e+01, 3.15264e+01, 3.48053e+01, 3.71565e+01,
                                                                        6.84397e+00, 7.63273e+00, 8.90652e+00, 1.01170e+01, 1.16509e+01, 2.72036e+01, 3.01435e+01, 3.28523e+01, 3.61909e+01, 3.85823e+01,
                                                                        7.43384e+00, 8.26040e+00, 9.59078e+00, 1.08508e+01, 1.24426e+01, 2.84120e+01, 3.14104e+01, 3.41696e+01, 3.75662e+01, 3.99968e+01,
                                                                        8.03365e+00, 8.89720e+00, 1.02829e+01, 1.15913e+01, 1.32396e+01, 2.96151e+01, 3.26706e+01, 3.54789e+01, 3.89322e+01, 4.14011e+01,
                                                                        8.64272e+00, 9.54249e+00, 1.09823e+01, 1.23380e+01, 1.40415e+01, 3.08133e+01, 3.39244e+01, 3.67807e+01, 4.02894e+01, 4.27957e+01,
                                                                        9.26042e+00, 1.01957e+01, 1.16886e+01, 1.30905e+01, 1.48480e+01, 3.20069e+01, 3.51725e+01, 3.80756e+01, 4.16384e+01, 4.41813e+01,
                                                                        9.88623e+00, 1.08564e+01, 1.24012e+01, 1.38484e+01, 1.56587e+01, 3.31962e+01, 3.64150e+01, 3.93641e+01, 4.29798e+01, 4.55585e+01,
                                                                        1.05197e+01, 1.15240e+01, 1.31197e+01, 1.46114e+01, 1.64734e+01, 3.43816e+01, 3.76525e+01, 4.06465e+01, 4.43141e+01, 4.69279e+01,
                                                                        1.11602e+01, 1.21981e+01, 1.38439e+01, 1.53792e+01, 1.72919e+01, 3.55632e+01, 3.88851e+01, 4.19232e+01, 4.56417e+01, 4.82899e+01,
                                                                        1.18076e+01, 1.28785e+01, 1.45734e+01, 1.61514e+01, 1.81139e+01, 3.67412e+01, 4.01133e+01, 4.31945e+01, 4.69629e+01, 4.96449e+01,
                                                                        1.24613e+01, 1.35647e+01, 1.53079e+01, 1.69279e+01, 1.89392e+01, 3.79159e+01, 4.13371e+01, 4.44608e+01, 4.82782e+01, 5.09934e+01,
                                                                        1.31211e+01, 1.42565e+01, 1.60471e+01, 1.77084e+01, 1.97677e+01, 3.90875e+01, 4.25570e+01, 4.57223e+01, 4.95879e+01, 5.23356e+01,
                                                                        1.37867e+01, 1.49535e+01, 1.67908e+01, 1.84927e+01, 2.05992e+01, 4.02560e+01, 4.37730e+01, 4.69792e+01, 5.08922e+01, 5.36720e+01,
                                                                        1.44578e+01, 1.56555e+01, 1.75387e+01, 1.92806e+01, 2.14336e+01, 4.14217e+01, 4.49853e+01, 4.82319e+01, 5.21914e+01, 5.50027e+01,
                                                                        1.51340e+01, 1.63622e+01, 1.82908e+01, 2.00719e+01, 2.22706e+01, 4.25847e+01, 4.61943e+01, 4.94804e+01, 5.34858e+01, 5.63281e+01,
                                                                        1.58153e+01, 1.70735e+01, 1.90467e+01, 2.08665e+01, 2.31102e+01, 4.37452e+01, 4.73999e+01, 5.07251e+01, 5.47755e+01, 5.76484e+01,
                                                                        1.65013e+01, 1.77891e+01, 1.98063e+01, 2.16643e+01, 2.39523e+01, 4.49032e+01, 4.86024e+01, 5.19660e+01, 5.60609e+01, 5.89639e+01,
                                                                        1.71918e+01, 1.85089e+01, 2.05694e+01, 2.24650e+01, 2.47967e+01, 4.60588e+01, 4.98018e+01, 5.32033e+01, 5.73421e+01, 6.02748e+01,
                                                                        1.78867e+01, 1.92327e+01, 2.13359e+01, 2.32686e+01, 2.56433e+01, 4.72122e+01, 5.09985e+01, 5.44373e+01, 5.86192e+01, 6.15812e+01,
                                                                        1.85858e+01, 1.99602e+01, 2.21056e+01, 2.40749e+01, 2.64921e+01, 4.83634e+01, 5.21923e+01, 5.56680e+01, 5.98925e+01, 6.28833e+01,
                                                                        1.92889e+01, 2.06914e+01, 2.28785e+01, 2.48839e+01, 2.73430e+01, 4.95126e+01, 5.33835e+01, 5.68955e+01, 6.11621e+01, 6.41814e+01,
                                                                        1.99959e+01, 2.14262e+01, 2.36543e+01, 2.56954e+01, 2.81958e+01, 5.06598e+01, 5.45722e+01, 5.81201e+01, 6.24281e+01, 6.54756e+01,
                                                                        2.07065e+01, 2.21643e+01, 2.44330e+01, 2.65093e+01, 2.90505e+01, 5.18051e+01, 5.57585e+01, 5.93417e+01, 6.36907e+01, 6.67660e+01,
                                                                        2.14208e+01, 2.29056e+01, 2.52145e+01, 2.73256e+01, 2.99071e+01, 5.29485e+01, 5.69424e+01, 6.05606e+01, 6.49501e+01, 6.80527e+01,
                                                                        2.21385e+01, 2.36501e+01, 2.59987e+01, 2.81440e+01, 3.07654e+01, 5.40902e+01, 5.81240e+01, 6.17768e+01, 6.62062e+01, 6.93360e+01,
                                                                        2.28595e+01, 2.43976e+01, 2.67854e+01, 2.89647e+01, 3.16255e+01, 5.52302e+01, 5.93035e+01, 6.29904e+01, 6.74593e+01, 7.06159e+01,
                                                                        2.35837e+01, 2.51480e+01, 2.75746e+01, 2.97875e+01, 3.24871e+01, 5.63685e+01, 6.04809e+01, 6.42015e+01, 6.87095e+01, 7.18926e+01,
                                                                        2.43110e+01, 2.59013e+01, 2.83662e+01, 3.06123e+01, 3.33504e+01, 5.75053e+01, 6.16562e+01, 6.54102e+01, 6.99568e+01, 7.31661e+01,
                                                                        2.50413e+01, 2.66572e+01, 2.91601e+01, 3.14390e+01, 3.42152e+01, 5.86405e+01, 6.28296e+01, 6.66165e+01, 7.12014e+01, 7.44365e+01,
                                                                        2.57746e+01, 2.74158e+01, 2.99562e+01, 3.22676e+01, 3.50814e+01, 5.97743e+01, 6.40011e+01, 6.78206e+01, 7.24433e+01, 7.57041e+01,
                                                                        2.65106e+01, 2.81770e+01, 3.07545e+01, 3.30981e+01, 3.59491e+01, 6.09066e+01, 6.51708e+01, 6.90226e+01, 7.36826e+01, 7.69688e+01,
                                                                        2.72493e+01, 2.89406e+01, 3.15549e+01, 3.39303e+01, 3.68182e+01, 6.20375e+01, 6.63386e+01, 7.02224e+01, 7.49195e+01, 7.82307e+01,
                                                                        2.79907e+01, 2.97067e+01, 3.23574e+01, 3.47643e+01, 3.76886e+01, 6.31671e+01, 6.75048e+01, 7.14202e+01, 7.61539e+01, 7.94900e+01,
                                                                        2.87347e+01, 3.04750e+01, 3.31618e+01, 3.55999e+01, 3.85604e+01, 6.42954e+01, 6.86693e+01, 7.26160e+01, 7.73860e+01, 8.07467e+01,
                                                                        2.94812e+01, 3.12457e+01, 3.39681e+01, 3.64371e+01, 3.94334e+01, 6.54224e+01, 6.98322e+01, 7.38099e+01, 7.86158e+01, 8.20008e+01,
                                                                        3.02300e+01, 3.20185e+01, 3.47763e+01, 3.72759e+01, 4.03076e+01, 6.65482e+01, 7.09935e+01, 7.50019e+01, 7.98433e+01, 8.32526e+01,
                                                                        3.09813e+01, 3.27934e+01, 3.55863e+01, 3.81162e+01, 4.11830e+01, 6.76728e+01, 7.21532e+01, 7.61920e+01, 8.10688e+01, 8.45019e+01,
                                                                        3.17348e+01, 3.35705e+01, 3.63981e+01, 3.89580e+01, 4.20596e+01, 6.87962e+01, 7.33115e+01, 7.73805e+01, 8.22921e+01, 8.57490e+01,
                                                                        3.24905e+01, 3.43495e+01, 3.72116e+01, 3.98013e+01, 4.29373e+01, 6.99185e+01, 7.44683e+01, 7.85672e+01, 8.35134e+01, 8.69938e+01,
                                                                        3.32484e+01, 3.51305e+01, 3.80267e+01, 4.06459e+01, 4.38161e+01, 7.10397e+01, 7.56237e+01, 7.97522e+01, 8.47328e+01, 8.82364e+01,
                                                                        3.40084e+01, 3.59135e+01, 3.88435e+01, 4.14920e+01, 4.46960e+01, 7.21598e+01, 7.67778e+01, 8.09356e+01, 8.59502e+01, 8.94769e+01,
                                                                        3.47704e+01, 3.66982e+01, 3.96619e+01, 4.23393e+01, 4.55770e+01, 7.32789e+01, 7.79305e+01, 8.21174e+01, 8.71657e+01, 9.07153e+01,
                                                                        3.55345e+01, 3.74849e+01, 4.04817e+01, 4.31880e+01, 4.64589e+01, 7.43970e+01, 7.90819e+01, 8.32977e+01, 8.83794e+01, 9.19517e+01,
                                                                        3.63005e+01, 3.82732e+01, 4.13031e+01, 4.40379e+01, 4.73418e+01, 7.55141e+01, 8.02321e+01, 8.44764e+01, 8.95913e+01, 9.31861e+01,
                                                                        3.70684e+01, 3.90633e+01, 4.21260e+01, 4.48890e+01, 4.82257e+01, 7.66302e+01, 8.13810e+01, 8.56537e+01, 9.08015e+01, 9.44187e+01,
                                                                        3.78382e+01, 3.98551e+01, 4.29503e+01, 4.57414e+01, 4.91105e+01, 7.77454e+01, 8.25287e+01, 8.68296e+01, 9.20100e+01, 9.56493e+01,
                                                                        3.86098e+01, 4.06486e+01, 4.37760e+01, 4.65949e+01, 4.99963e+01, 7.88596e+01, 8.36753e+01, 8.80041e+01, 9.32169e+01, 9.68781e+01,
                                                                        3.93831e+01, 4.14436e+01, 4.46030e+01, 4.74496e+01, 5.08829e+01, 7.99730e+01, 8.48206e+01, 8.91771e+01, 9.44221e+01, 9.81051e+01,
                                                                        4.01582e+01, 4.22402e+01, 4.54314e+01, 4.83054e+01, 5.17705e+01, 8.10855e+01, 8.59649e+01, 9.03489e+01, 9.56257e+01, 9.93304e+01,
                                                                        4.09350e+01, 4.30384e+01, 4.62610e+01, 4.91623e+01, 5.26588e+01, 8.21971e+01, 8.71081e+01, 9.15194e+01, 9.68278e+01, 1.00554e+02,
                                                                        4.17135e+01, 4.38380e+01, 4.70920e+01, 5.00202e+01, 5.35481e+01, 8.33079e+01, 8.82502e+01, 9.26885e+01, 9.80284e+01, 1.01776e+02,
                                                                        4.24935e+01, 4.46392e+01, 4.79242e+01, 5.08792e+01, 5.44381e+01, 8.44179e+01, 8.93912e+01, 9.38565e+01, 9.92275e+01, 1.02996e+02,
                                                                        4.32752e+01, 4.54417e+01, 4.87576e+01, 5.17393e+01, 5.53289e+01, 8.55270e+01, 9.05312e+01, 9.50232e+01, 1.00425e+02, 1.04215e+02,
                                                                        4.40584e+01, 4.62457e+01, 4.95922e+01, 5.26003e+01, 5.62206e+01, 8.66354e+01, 9.16702e+01, 9.61887e+01, 1.01621e+02, 1.05432e+02,
                                                                        4.48431e+01, 4.70510e+01, 5.04279e+01, 5.34623e+01, 5.71129e+01, 8.77430e+01, 9.28083e+01, 9.73531e+01, 1.02816e+02, 1.06648e+02,
                                                                        4.56293e+01, 4.78577e+01, 5.12648e+01, 5.43253e+01, 5.80061e+01, 8.88499e+01, 9.39453e+01, 9.85163e+01, 1.04010e+02, 1.07862e+02,
                                                                        4.64170e+01, 4.86657e+01, 5.21028e+01, 5.51892e+01, 5.89000e+01, 8.99560e+01, 9.50815e+01, 9.96783e+01, 1.05202e+02, 1.09074e+02,
                                                                        4.72060e+01, 4.94750e+01, 5.29419e+01, 5.60541e+01, 5.97946e+01, 9.10615e+01, 9.62167e+01, 1.00839e+02, 1.06393e+02, 1.10286e+02,
                                                                        4.79965e+01, 5.02856e+01, 5.37821e+01, 5.69198e+01, 6.06899e+01, 9.21662e+01, 9.73510e+01, 1.01999e+02, 1.07583e+02, 1.11495e+02,
                                                                        4.87884e+01, 5.10974e+01, 5.46234e+01, 5.77864e+01, 6.15858e+01, 9.32702e+01, 9.84844e+01, 1.03158e+02, 1.08771e+02, 1.12704e+02,
                                                                        4.95816e+01, 5.19104e+01, 5.54656e+01, 5.86539e+01, 6.24825e+01, 9.43735e+01, 9.96169e+01, 1.04316e+02, 1.09958e+02, 1.13911e+02,
                                                                        5.03761e+01, 5.27247e+01, 5.63089e+01, 5.95223e+01, 6.33799e+01, 9.54762e+01, 1.00749e+02, 1.05473e+02, 1.11144e+02, 1.15117e+02,
                                                                        5.11719e+01, 5.35401e+01, 5.71532e+01, 6.03915e+01, 6.42778e+01, 9.65782e+01, 1.01879e+02, 1.06629e+02, 1.12329e+02, 1.16321e+02,
                                                                        5.19690e+01, 5.43566e+01, 5.79984e+01, 6.12615e+01, 6.51765e+01, 9.76796e+01, 1.03010e+02, 1.07783e+02, 1.13512e+02, 1.17524e+02,
                                                                        5.27674e+01, 5.51743e+01, 5.88446e+01, 6.21323e+01, 6.60757e+01, 9.87803e+01, 1.04139e+02, 1.08937e+02, 1.14695e+02, 1.18726e+02,
                                                                        5.35669e+01, 5.59931e+01, 5.96918e+01, 6.30039e+01, 6.69756e+01, 9.98805e+01, 1.05267e+02, 1.10090e+02, 1.15876e+02, 1.19927e+02,
                                                                        5.43677e+01, 5.68130e+01, 6.05398e+01, 6.38763e+01, 6.78761e+01, 1.00980e+02, 1.06395e+02, 1.11242e+02, 1.17057e+02, 1.21126e+02,
                                                                        5.51696e+01, 5.76339e+01, 6.13888e+01, 6.47494e+01, 6.87772e+01, 1.02079e+02, 1.07522e+02, 1.12393e+02, 1.18236e+02, 1.22325e+02,
                                                                        5.59727e+01, 5.84559e+01, 6.22386e+01, 6.56233e+01, 6.96788e+01, 1.03177e+02, 1.08648e+02, 1.13544e+02, 1.19414e+02, 1.23522e+02,
                                                                        5.67769e+01, 5.92790e+01, 6.30894e+01, 6.64979e+01, 7.05810e+01, 1.04275e+02, 1.09773e+02, 1.14693e+02, 1.20591e+02, 1.24718e+02,
                                                                        5.75823e+01, 6.01030e+01, 6.39409e+01, 6.73732e+01, 7.14838e+01, 1.05372e+02, 1.10898e+02, 1.15841e+02, 1.21767e+02, 1.25913e+02,
                                                                        5.83888e+01, 6.09281e+01, 6.47934e+01, 6.82493e+01, 7.23872e+01, 1.06469e+02, 1.12022e+02, 1.16989e+02, 1.22942e+02, 1.27106e+02,
                                                                        5.91963e+01, 6.17541e+01, 6.56466e+01, 6.91260e+01, 7.32911e+01, 1.07565e+02, 1.13145e+02, 1.18136e+02, 1.24116e+02, 1.28299e+02,
                                                                        6.00049e+01, 6.25811e+01, 6.65007e+01, 7.00035e+01, 7.41955e+01, 1.08661e+02, 1.14268e+02, 1.19282e+02, 1.25289e+02, 1.29491e+02,
                                                                        6.08146e+01, 6.34090e+01, 6.73556e+01, 7.08816e+01, 7.51005e+01, 1.09756e+02, 1.15390e+02, 1.20427e+02, 1.26462e+02, 1.30681e+02,
                                                                        6.16253e+01, 6.42379e+01, 6.82112e+01, 7.17603e+01, 7.60060e+01, 1.10850e+02, 1.16511e+02, 1.21571e+02, 1.27633e+02, 1.31871e+02,
                                                                        6.24370e+01, 6.50677e+01, 6.90677e+01, 7.26398e+01, 7.69119e+01, 1.11944e+02, 1.17632e+02, 1.22715e+02, 1.28803e+02, 1.33059e+02,
                                                                        6.32496e+01, 6.58984e+01, 6.99249e+01, 7.35198e+01, 7.78184e+01, 1.13038e+02, 1.18752e+02, 1.23858e+02, 1.29973e+02, 1.34247e+02,
                                                                        6.40633e+01, 6.67299e+01, 7.07828e+01, 7.44005e+01, 7.87254e+01, 1.14131e+02, 1.19871e+02, 1.25000e+02, 1.31141e+02, 1.35433e+02,
                                                                        6.48780e+01, 6.75624e+01, 7.16415e+01, 7.52819e+01, 7.96329e+01, 1.15223e+02, 1.20990e+02, 1.26141e+02, 1.32309e+02, 1.36619e+02,
                                                                        6.56936e+01, 6.83957e+01, 7.25009e+01, 7.61638e+01, 8.05408e+01, 1.16315e+02, 1.22108e+02, 1.27282e+02, 1.33476e+02, 1.37803e+02,
                                                                        6.65101e+01, 6.92299e+01, 7.33611e+01, 7.70463e+01, 8.14493e+01, 1.17407e+02, 1.23225e+02, 1.28422e+02, 1.34642e+02, 1.38987e+02,
                                                                        6.73276e+01, 7.00649e+01, 7.42219e+01, 7.79295e+01, 8.23581e+01, 1.18498e+02, 1.24342e+02, 1.29561e+02, 1.35807e+02, 1.40169e+02).finished();

#endif